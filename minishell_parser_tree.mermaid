graph TD
    A["Entrada: Línea de comando"] --> B["Tokenizar"]
    B --> C["¿Tokens válidos?"]
    C -->|No| D["Error: Sintaxis inválida"]
    C -->|Sí| E["Crear nodo raíz"]
    
    E --> F["Buscar operadores de mayor precedencia<br/>pipes, redirects, lógicos"]
    
    F --> G{¿Encontrado<br/>operador?}
    G -->|No| H["Comando simple<br/>hoja del árbol"]
    G -->|Sí| I["Dividir en izquierda<br/>y derecha"]
    
    I --> J["Recursión lado izquierdo"]
    I --> K["Recursión lado derecho"]
    
    J --> L["Procesar subárbol<br/>izquierdo"]
    K --> M["Procesar subárbol<br/>derecho"]
    
    L --> N["¿Es hoja?"]
    M --> O["¿Es hoja?"]
    
    N -->|Sí| P["Parsear comando simple<br/>args + redirects"]
    N -->|No| Q["Nodo operador"]
    
    O -->|Sí| R["Parsear comando simple<br/>args + redirects"]
    O -->|No| S["Nodo operador"]
    
    P --> T["Nodo completo"]
    Q --> T
    R --> U["Nodo completo"]
    S --> U
    
    T --> V["Árbol binario construido"]
    U --> V
    
    V --> W["Ejecutar árbol<br/>en postorden"]
    W --> X["Aplicar operadores<br/>según tipo"]
    
    style A fill:#e1f5ff
    style D fill:#ffcdd2
    style H fill:#c8e6c9
    style P fill:#c8e6c9
    style R fill:#c8e6c9
    style V fill:#fff9c4
    style W fill:#f3e5f5